library(caret)
library(ggplot2)
library(ISLR)
data(Wage)
Wage <- subset(Wage,select=-c(logwage))
summary(Wage)
inTrain <- createDataPartition(y=Wage$wage,p=0.7,list=FALSE)
training <- Wage[inTrain,]
testing <- Wage[-inTrain,]
dim(training)
dim(testing)
featurePlot(x=training[,c("age","education","jobclass")],y=training$wage,plot="pairs")
qplot(age,wage,data=training)
qplot(age,wage,data=training,col= jobclass)
qplot(age,wage,data=training,col= education)
modFit <- train(wage~age+education+jobclass,method="lm",data=training)
finMod <- modFit$finalModel
print(modFit)
plot(finMod,1,pch=19,cex=0.5,col="#00000010")
qplot(finMod$fitted,finMod$residuals,col=race,data=training)
cor(finMod$fitted.values,finMod$residuals)
plot(finMod$residuals,pch=19)
pred <- predict(modFit,testing)
qplot(wage,pred,col=year,data=testing)
cor(testing$wage,pred)
modFitAll <- train(wage~.,method="lm",data=training)
pred <- predict(modFitAll,testing)
qplot(wage,pred,data=testing)
cor(testing$wage,pred)
